<!DOCTYPE html>
<html lang="en">
<title>{%block title %}Search Results{% endblock %}</title>
{% block head %}
<head>
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    
    <!-- jQuery -->
    <script src="{{ url_for('static', filename='js/jquery.js') }}"></script>
    <!-- Bootstrap 3.0 CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap 3.3.5 Javasript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='stylesheets/about.css') }}" rel="stylesheet">
    <!-- Table JS -->
    <script src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
    <!-- Table JS - Bootstrap specific -->
    <script src="https://cdn.datatables.net/1.10.10/js/dataTables.bootstrap.min.js"></script>

    <script>
    //<!-- Menu Toggle Script -->
          $("#menu-toggle").click(function(e) {
                e.preventDefault();
                $("#wrapper").toggleClass("toggled");
           });

        
         $(document).ready(function() {
            {% for i in range(0, len(ordering)) %}
                $('#dataTable{{ordering[i].title() }}').DataTable();
            {% endfor %}
          });
         
    </script>
    <!-- Table CSS -->
    <link href="https://cdn.datatables.net/1.10.10/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='stylesheets/search_results.css') }}" rel="stylesheet">
</head>

{% endblock %}

<body>
   <div class="wrapper animsition"> <!-- BEGIN WRAPPER DIV -->
    <!-- BEGIN NAVIGATION -->
    {% block nav %}
    <nav class="navbar navbar-inverse navbar-static-top topnav" role="navigation">
        <div class="container-fluid">       <!--DEFAULT WAS CONTAINER TOPNAV -->
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->

            <!-- <div class="homepage">
                <a href="/index">MurikinMade</a>
            </div> -->

            <div class="collapse navbar-collapse navbar-right" id="navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right animsition">
                    <li style="margin-right:190px;font-size:40px;font-weight:bold"><a href="/index">MurikinMade</a></li>
                    <li class="menu"><a href="/about">ABOUT</a></li>
                    <li class="menu"><a href="/makes">MAKES</a></li>
                    <li class="menu"><a href="/engines">ENGINES</a></li>
                    <li class="menu"><a href="/models">MODELS</a></li>
                    <li class="menu"><a href="/transmissions">TRANSMISSIONS</a></li>
                    <li class="menu"><a href="/types">TYPES</a></li>
                    <li class="menu">
                        <!--search bar-->
                        <div id="tfheader">
                            <form action="/search" id="tfsearch" method="get">
                                <input type="text" class="tftextinput" name="q" size="21" maxlength="120">
                                <input type="submit" value="SEARCH" class="tfbutton">
                            </form>
                        </div>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>
    <!-- END NAVIGATION -->
    {% endblock %}

    {% block content %}
    <div class="container">
      <h2>Search Results</h2>
      <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#{{ ordering[0] }}">{{ ordering[0] }}</a></li>
        {% for i in range(1, len(ordering)) %}
        <li><a data-toggle="tab" href="#{{ ordering[i] }}">{{ ordering[i] }}</a></li>
        {% endfor %}
      </ul>

      <div class="tab-content">
      {% set model = ordering[0] %}
        <div id="{{ordering[0]}}" class="tab-pane fade in active">
        <h1 class="description">American Vehicle {{ model.title() }}</h1>
            <!-- Table demo -->
            <div>
                <table id="dataTable{{ ordering[0].title() }}" class="table table-striped table-bordered" width="100%">
                    <thead >
                    <tr>
                        {% for h in query_dict[model][HEADER_IDX] %}
                        <th>{{ h }}</th>
                        {% endfor %}
                    </tr>
                    </thead>
                    <tbody>
                    {% for v in items[model] %}
                    <tr>
                    {% for k, f in z(query_dict[model][KEY_IDX], query_dict[model][FUNCTION_IDX]) %}
                    {% set query_item = query_dict[model][DB_IDX].query.filter_by(id=v).first() %}
                    {% set header_val, key_val = f(k, query_item) %}
                        <td>{{ key_val|safe }}</td>
                    {% endfor %}
                    </tr>
                    {% endfor %}
                    </tbody>
                </table> 
            </div>
        </div>
        {% for i in range(1, len(ordering)) %}
            {% set model = ordering[i] %}
                <div id="{{model}}" class="tab-pane fade active">
                <h1 class="description">American Vehicle {{ model.title() }}</h1>
                <!-- Table demo -->
                <div>
                    <table id="dataTable{{ ordering[i].title() }}" class="table table-striped table-bordered" width="100%">
                        <thead>
                        <tr>
                            {% for h in query_dict[model][HEADER_IDX] %}
                            <th>{{ h }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for v in items[model] %}
                        <tr>
                        {% for k, f in z(query_dict[model][KEY_IDX], query_dict[model][FUNCTION_IDX]) %}
                        {% set query_item = query_dict[model][DB_IDX].query.filter_by(id=v).first() %}
                        {% set header_val, key_val = f(k, query_item) %}
                            <td>{{ key_val|safe }}</td>
                        {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table> 
                </div>
                </div>
        {% endfor %}
      </div>
    </div>
</body>
{% endblock %}